library(corrplot)
library(tidyverse)
library(randomForest)
library(car)
library(caret)
library(rpart)
library(tree)

#/*What draft models I did, what variables I used, what manipulation I ended up doing.* --> 1-2 pages.
#/*Use MSE or R-square


setwd("C:/Users/thoma/Desktop/Spring 2019/Linear Model 2/Project")
training <- read.csv("training.csv")
test <- read.csv("validation.csv")

training$SalePrice <- log(training$SalePrice)
test$SalePrice <- log(test$SalePrice)

select_var <- c('SalePrice', 'GarageArea', 'TotRmsAbvGrd', 'BedroomAbvGr','KitchenAbvGr', 'HalfBath', 'FullBath', 'GrLivArea', 'TotalBsmtSF', 'OverallQual', 'OverallCond', 'YearBuilt', 'LotArea', 'Id')
select_training <- training[,select_var]
df_train <-na.roughfix(select_training)

lm1 <- lm(SalePrice ~ ., data = select_training)
prediction <- predict(lm1, test, type="response")
RMSE(test$SalePrice, prediction)
pred_lm1 <- predict(lm1, newdata=test)
pred_lm1_df <- data.frame(pred_lm1)
test_lm1_df <- cbind(test$SalePrice, pred_lm1_df)
head(test_lm1_df)

correlations <- cor(select_training, use="everything")
corrplot(correlations, method="circle", type="lower",  sig.level = 0.05, insig = "blank")
step(lm1)

set.seed(1234)
tree <- rpart(select_training$SalePrice ~ ., data = select_training)
prediction2 <- predict(tree, newdata=test)
RMSE(test$SalePrice, prediction2)
pred_tree <- predict(tree, newdata=test)
pred_tree_df <- data.frame(pred_tree)
test_tree_df <- cbind(test$SalePrice, pred_tree_df)
head(test_tree_df)

rf1 <- randomForest(SalePrice ~., data=select_training, ntree=500)
prediction3 <- predict(rf1, newdata=test)
RMSE(test$SalePrice, prediction3)
pred_rf <- predict(rf1, newdata=test)
pred_rf_df <- data.frame(pred_rf)
test_rf_df <- cbind(test$SalePrice, pred_rf_df)
head(test_rf_df)
